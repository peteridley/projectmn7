
<html class="" lang="">
	<head>
	{% include 'partials/header' %}

	<!----------------------------- Navigation ------------------------------------>


	    <section>

	<nav class="navbar" role="navigation" aria-label="main navigation">
	    <div class ="container">
	  <div class="navbar-brand">

	    <a class="navbar-item" href="{{ url('/') }}">
	        {% set asset = navigation.mainlogo.one() %}
	        {% if asset %}
	        <img class = "" src = "{{ asset.url}}">
	        {% endif %}
	    </a>

			<div class = "search">
				<form action="{{ url('search/results') }}" method="get">


				 <div class="field has-addons">

							 <div class="control is-expanded top-search">
										<input class = "input" type="search" name="q" placeholder="Search Majors, Awards or Universitiesâ€¦">
							 </div>

				 </div>

			</div>

	    <div class = "menu-wrapper">
	    <div class = "linkstyle-1">
	      <a href = "{{ url('static/faq') }}"> FAQs & Guides</a>
	      <a href = "#"> Contact </a>
	          </div>



	    <div class = "social-icons">
	      <a href = "#">  <img class = "facebook" src = "/images/statics/facebook-blue.png"> </a>
	      <a href = "#">  <img class = "instagram" src = "/images/statics/instagram-blue.png"> </a>
	      <a href = "#">  <img class = "twitter" src = "/images/statics/twitter-blue.png"> </a>
	    </div>
	</div>

	  </div>
	  </div>
	</nav>

	</section>
	</head>

	<body class="">

<!-------------------------------------------------------------------------->
	<section class="top">
		<div class = "container">
			<div class = "filter">

				<!-- - - - - - - - - Form Start - - - - - - - - - - - - - - - - - - -->


					 <div class="columns is-variable is-1">
						 <div class = "columns">
							 <div class = "column">
								 <div class = "columns">

								 	<div class="column is-filter">
										 <div class="field">
											 <div class="control">
											 	<div class="select is-fullwidth is-multiple">

												 <!-- Level of study -->
												 <select class = "resultsselect" name="los" onchange="this.form.submit()" >
														 <option value="">All Levels</option>

														 {% set categories = craft.categories.group('lostudy') %}
														 {% for category in categories %}
														 <option value="{{ category.slug }}">{{ category.title }}</option>
														 {% endfor %}
												 </select>

											 </div>
										 </div>
									 </div>
								 </div>

							 <div class="column">

						 			 <div class="field">
						 				 <div class="control">
							 				 <div class="select is-fullwidth is-multiple location">
	 										 <!-- Location -->
														 <select class = "resultsselect" name="location" id="sally" onchange="this.form.submit()" >
																 <option value="">All Locations</option>
																 {% set categories = craft.categories.group('locations') %}
																 {% for category in categories %}
																		 <option value="{{ category.slug }}">{{ category.title }}</option>
																 {% endfor %}
														 </select>

							 				</div>
						 				</div>
						 			</div>

					 		</div>

							 <div class="column">

								 <!-- Program Length-->

										<div class="field">
											<div class="control">
	 										<div class="select is-fullwidth is-multiple">

												<select class = "resultsselect" name="programlength" onchange="this.form.submit()">
														<option value="">Program Length</option>
														{% set categories = craft.categories.group('programlength') %}
														{% for category in categories %}
																<option value="{{ category.slug }}">{{ category.title }}</option>
														{% endfor %}
												</select>
		 									 </div>
		 								 </div>
		 							 </div>

								</div>



								<div class="column">

									<!-- Tuition -->
										<div class="field">
											<div class="control">
												<div class="select is-fullwidth is-multiple">

													<select class = "resultsselect" name="tuition" onchange="this.form.submit()">
															<option value="">Tuition</option>
															{% set categories = craft.categories.group('tuition') %}
															{% for category in categories %}
																	<option value="{{ category.slug }}">{{ category.title }}</option>
															{% endfor %}
													</select>

											 </div>
										 </div>
									 </div>

								</div>




										<div class="column">

									 <!-- Award Type -->
											<div class="field">
												<div class="control">
												 	<div class="select is-fullwidth is-multiple">

													 <select class = "resultsselect" name="awardtype" onchange="this.form.submit()">
															 <option value="">Award Type</option>
															 {% set categories = craft.categories.group('awardtype') %}
															 {% for category in categories %}
																	 <option value="{{ category.slug }}">{{ category.title }}</option>
															 {% endfor %}
													 </select>

												</div>
											</div>
										</div>
									</div>

									<div class="column">

										<!-- Language -->
										 <div class="field">
											 <div class="control">
												 <div class="select is-fullwidth is-multiple">

													 <select class = "resultsselect" name="courselanguage" onchange="this.form.submit()">
															 <option value="">Language</option>
															 {% set categories = craft.categories.group('courselanguage') %}
															 {% for category in categories %}
																	 <option value="{{ category.slug }}">{{ category.title }}</option>
															 {% endfor %}
													 </select>

												  </div>
										  	</div>
										 </div>

								</div>

								<div class="column">


									 <div class="field">

										 <div class="select is-fullwidth is-multiple">
											 <select class = "resultsselect" name="housing" onchange="this.form.submit()">
												 		<option value = "">Housing</option>
													 {% set categories = craft.categories.group('housing') %}
													 {% for category in categories %}
															 <option value="{{ category.slug }}">{{ category.title }}</option>
													 {% endfor %}
											 </select>

										</div>

								</div>
							</div>

							<div class="column">


								 <div class="field">
									 <div class="control">
									 <div class="select is-fullwidth is-multiple">
										 <select class = "resultsselect" name="monthlyallowance" onchange="this.form.submit()">
													<option value="">Allowance</option>
													{% set categories = craft.categories.group('monthlyallowance') %}
													{% for category in categories %}
															<option value="{{ category.slug }}">{{ category.title }}</option>
													{% endfor %}
											</select>

									</div>
								</div>
							</div>
						</div>

						<div class="column ">


							 <div class="field">

								 <div class="select is-fullwidth is-multiple">
									 <select class = "clearfilter" name="" onchange="this.form.submit()">
												<option value = "">Clear Filters</option>

									 </select>

								</div>

						</div>
					</div>


					</div>
				</div>
			</div>
</div>
			</form>
<!-- - - - - - - - - Form End - - - - - - - - - - - - - - - - - - -->


				</div>
			</div>

			<div class = "greybreak"></div>
		</section>


<!-------------------- Set search parameters ------------------------------------->

{# Get the search data #}
{% set locationParam = craft.app.request.getParam('location') %}
{% set awardParam = craft.app.request.getParam('awardtype') %}
{% set languageParam = craft.app.request.getParam('courselanguage') %}
{% set housingParam = craft.app.request.getParam('housing') %}
{% set allowanceParam = craft.app.request.getParam('monthlyallowance') %}
{% set programlengthParam = craft.app.request.getParam('programlength') %}
{% set tuitionParam = craft.app.request.getParam('tuition') %}
{% set losParam = craft.app.request.getParam('los') %}
{% set query = craft.app.request.getParam( 'q' ) %}

{# Compose the relation param #}
{% set relationParam = ['and'] %}

{% if locationParam %}
{% set location = craft.categories.group('locations').slug(locationParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: location }]) %}
{% endif %}

{% if losParam %}
{% set los = craft.categories.group('lostudy').slug(losParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: los }]) %}
{% endif %}

{% if awardParam %}
{% set awardtype = craft.categories.group('awardtype').slug(awardParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: awardtype }]) %}
{% endif %}

{% if languageParam %}
{% set courselanguage = craft.categories.group('courselanguage').slug(languageParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: courselanguage }]) %}
{% endif %}

{% if programlengthParam %}
{% set programlength = craft.categories.group('programlength').slug(programlengthParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: programlength }]) %}
{% endif %}

{% if allowanceParam %}
{% set monthlyallowance = craft.categories.group('monthlyallowance').slug(allowanceParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: monthlyallowance }]) %}
{% endif %}

{% if housingParam %}
{% set housing = craft.categories.group('housing').slug(housingParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: housing }]) %}
{% endif %}

{% if tuitionParam %}
{% set tuition = craft.categories.group('tuition').slug(tuitionParam).one() %}
{% set relationParam = relationParam|merge([{ targetElement: tuition }]) %}
{% endif %}

{# Avoid passing an array with `['and']` only #}
{% if relationParam|length < 2 %}
{% set relationParam = '' %}
{% endif %}



{# Find and list matching entries #}
{% set entries = craft.entries.relatedTo(relationParam).all() %}

{% paginate craft.entries.relatedTo(relationParam).limit(8) as entries  %}


<!-------------------------------------------------------------------------------->


<section>

	<div class = "container">
		<div class = "columns">
			<div class = "column is-offset-1 is-10">

				{% set searchTerms = query | trim | split( ' ' ) %}

				{# Build an associated array w/ terms and the replacement string #}

				{% set replace = {} %}
				{% for term in searchTerms %}
				{% set replace = replace | merge( { (term) : '<span>' ~ term ~ '</span>' } ) %}

				{% endfor %}

				{% if entries|length %}



				<!-- Title -->
				<h1 class = "text style-2"><strong>{{ entries |length }}</strong> results for <strong>{{query}}</strong> in <strong>{{locationParam}} </strong></h1>

				<div class = "blankbreak"> </div>
				<!-- Pagination -->








				<nav class="pagination is-small" role="navigation" aria-label="pagination">
					<a class="pagination-previous">Previous</a>
					<a class="pagination-next">Next page</a>

					<ul class="pagination-list">

						{% for page, url in paginate.getPrevUrls(5) %}
								<li><a  class = "pagination-link" href="{{ url }}">{{ page }}</a>
						{% endfor %}

						<span class="pagination-link">{{ paginate.currentPage }}</span>

						{% for page, url in paginate.getNextUrls(5) %}
							<li><a  class = "pagination-link" href="{{ url }}">{{ page }}</a>
						{% endfor %}

					</ul>
				</nav>

				<div class = "bluebreak"> </div>
				{# Loop through your search results, replacing the terms for all neccessary fields..#}

		</div>
	</div>

<!-------------------------- Card ------------------------------------------------>


	{% for entry in entries if entry.type == "awards" %}


	<div class = "columns">
		<div class = "column is offset-1 is 10">

			<div class = "columns">
		<!--  University Logo -->
		<div class = "column is-offset-1 is-2">

			{% if entry.university|length %}
			{% for university in entry.university %}

			{% set asset = university.universitylogo.one() %}
			{% if asset %}

			<div class = "logo2 image is-128x128">
				<img src="{{ asset.url ('unilogo') }}"/>
				{% endif %}

			</div>

		</div>

		<!-- Scholarship Title -->
		<div class = "column  is-5">
			<div>
				<a class = "linkstyle-2" href="{{ entry.url }}">{{ entry.title | replace( replace ) | raw }}</a>
				{% set text %}
				<p>  provided by {{university.title}} </p>
				<p class = "awarddescription">{{ entry.awarddescription | replace( replace ) | raw }}</p>

				{% endset %}
				{{ text | chop(limit=200, unit = 'c', allowedTags="<p>", append='...') }}
			</div>

		</div>

		{% endfor %}
		{% endif %}
		<div class = "column is-offset-1 is-2">
			<div class = "apply">	<a class = "button is-info is-fullwidth" href = "{{ entry.apply }}">  Apply </p> </a> </div>
			<div class = "more-info"><a class = "button is-outlined is-fullwidth" href = "{{ entry.url }}">  More Details </p> </a></div>
		</div>

	</div>


<div class = "columns">
	<div class = "column is-offset-3 is-6">
		<div class = "columns">

	<!-- Deadline -->
	<div class = "column divider">
	<h3 class="text style-3"> Deadline</h3>
	<p class = "text style-4">{{ entry.headerinformation.deadline }}</p>
</div>

<!-- Level of study -->
<div class = "column divider">
	<h3 class="text style-3">Level of study </h3>
	<p class="text style-4"></p>

</div>

<!-- Location -->
<div class = "column">
	<h3 class="text style-3">Location</h3>
	{% set categories = craft.categories.group('location') %}
	{% for category in categories %}
	<p class="text style-4">{{ location.title }}</p>
 	{% endfor %}
</div>
</div>

</div>

</div>
		<div class = "columns">
			<div class = "column is-offset-1 is-10">
					<div class = "bluebreak"> </div>

			</div>
		</div>



	</div>
</div>



	<!------------------------------------------------------------------------------>


	{% endfor %}
<div class = "blankbreak"> </div>
<div class = "blankbreak"> </div>
</div>

	{% else %}

<div class = "sorry">
<h1 class = "text style-1">  Sorry no results </h1>
	<div class = "linkstyle-1">	<a href="javascript:history.back()"> 	<span class="icon"> <i class="fa fa-angle-left"></i></span> Search again</a>	</div>
</div>
{% endif %}

</section>











		</body>
		{% include 'partials/footer' %}
</html>
